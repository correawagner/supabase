---
title: 'Restore Dashboard backup'
subtitle: 'Learn how to restore your dashboard backup to a new Supabase project'
breadcrumb: 'Migrations'
---

## Before you begin

<Accordion
  type="default"
  openBehaviour="multiple"
  chevronAlign="right"
  justified
  size="medium"
  className="text-foreground-light mt-8 mb-6"
>
  <div className="border-b mt-3 pb-3">
    <AccordionItem
      header="Install Postgresql which includes psql"
      id="item-1"
    >
      <PostgresInstallation />
    </AccordionItem>

  </div>
  <div className="border-b mt-3 pb-3">
    <AccordionItem
      header="Create and configure a new project"
      id="item-2"
    >
      <StepHikeCompact>
      <StepHikeCompact.Step step={1}>
        <StepHikeCompact.Details title="Create New project" fullWidth>
          Create a new [Supabase project](https://database.new)
        </StepHikeCompact.Details>
      </StepHikeCompact.Step>
        <StepHikeCompact.Step step={2}>
          <StepHikeCompact.Details title="Configure your new project" fullWidth>
                In your new project:

                - If you were using Webhooks, enable [Database Webhooks](https://supabase.com/dashboard/project/_/database/hooks).
                - If you were using any extensions, enable the [Extensions](https://supabase.com/dashboard/project/_/database/extensions).
                - If you were using Replication for Realtime, enable [Publication](https://supabase.com/dashboard/project/_/database/publications) on the tables where you had it enabled
          </StepHikeCompact.Details>
        </StepHikeCompact.Step>
      </StepHikeCompact>
    </AccordionItem>

  </div>
</Accordion>

## Restore backup

<StepHikeCompact>
  <StepHikeCompact.Step step={1}>
    <StepHikeCompact.Details title="Get the new database connection string" fullWidth>
      Go to the [project page](https://supabase.com/dashboard/project/_/) and click the "**Connect**" button at the top of the page for the connection string.

      <Admonition type="info">
        Use the Session pooler connection string if there are any doubts. If you are sure that you have an IPv6 compatible connection, then you can use the direct connection string instead.
      </Admonition>

      Session pooler connection string:
      ```bash
        postgresql://postgres.[PROJECT-REF]:[YOUR-PASSWORD]@aws-0-us-east-1.pooler.supabase.com:5432/postgres
      ```

      Direct connection string:
      ```bash
        postgresql://postgres.[PROJECT-REF]:[YOUR-PASSWORD]@db.[PROJECT-REF].supabase.com:5432/postgres
      ```
    </StepHikeCompact.Details>

  </StepHikeCompact.Step>
<StepHikeCompact.Step step={2}>
  <StepHikeCompact.Details title="Get the database password" fullWidth>
    Reset the password in the [Database Settings](https://supabase.com/dashboard/project/_/settings/database).

    Replace ```[YOUR-PASSWORD]``` in the connection string with the database password.

  </StepHikeCompact.Details>
</StepHikeCompact.Step>

<StepHikeCompact.Step step={3}>
  <StepHikeCompact.Details title="Get the downloaded backup file path" fullWidth>
    Get the relative file path of the downloaded backup file. 
    
    If the restore is done in the same directory as the downloaded backup, the file path would look like this:

    ```./backup_name.backup```

  </StepHikeCompact.Details>
</StepHikeCompact.Step>

<StepHikeCompact.Step step={4}>
  <StepHikeCompact.Details title="Verify the backup file format" fullWidth>
    The backup file will be gzipped with a .gz extension. You will need to unzip the file to look like this:

    `backup_name.backup`

  </StepHikeCompact.Details>
</StepHikeCompact.Step>

<StepHikeCompact.Step step={5}>
    <StepHikeCompact.Details title="Restore your backup" fullWidth>
      <StepHikeCompact.Code>
        ```sql
        psql -d [CONNECTION_STRING] -f /file/path
        ```
      </StepHikeCompact.Code>

      Replace ```[CONNECTION_STRING]``` with connection string from Steps 1 & 2.

      Replace ```/file/path``` with the file path from Step 3.

      Run the command with the replaced values to restore the backup to your new project.
    </StepHikeCompact.Details>

  </StepHikeCompact.Step>
</StepHikeCompact>

## Migrate storage objects to new project's S3 storage

<Admonition type="info">
  The Google Colab migration script requires uploading to Google colab first and then to the S3
  buckets. This could add significant upload time if there are large storage objects.
</Admonition>
After restoring the backup, the buckets and files metadata will show up in the dashboard of the new project.
However, the storage files stored in the S3 buckets would not be present.

Use the following Google colab script provided below to migrate your downloaded storage objects to your new project's S3 buckets.

[![Open In Colab](https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/github/PLyn/supabase-storage-migrate/blob/main/Supabase_Storage_migration.ipynb)

## Common errors with the backup restore process

"**ERROR: must be member of role ROLE**"
"**ERROR: grant options cannot be granted back to your own grantor**"
"**ERROR: constraint CONSTRAINT for relation RELATION already exists**"
"**...Too many to list here**"

These are expected to happen when restoring the backup to a new Supabase project. The backup provided by the dashboard is a full dump which contains the CREATE commands for all schemas. Upon Supabase project creation, the CREATE and other commands are run for schemas such as auth and storage before the restore process is run. As a result, the restoration process will fail when running these commands that have already been applied to the project on creation.

This is by design as the full dump allows you to rebuild the entire database from scratch even outside of Supabase. It is not a problem because it will skip to the next command to run in these scenarios. Another reason that errors can happen is due to triggers in your database being run during the restoration. This can happen because this method of restoring the backup cannot set the session variable "session_replication_role" to "replica" to avoid this.

There are circumstances where this method can fail and if it does, you should reach out to Supabase support for help.

"**psql: error: connection to server at "aws-0-us-east-1.pooler.supabase.com" (44.216.29.125), port 5432 failed: received invalid response to GSSAPI negotiation:**"

The most likely reason for this is that you are using psql and postgres version 15 or lower. Completely remove the Postgresql installation and install the latest version as per the instructions above to resolve this issue.

"**psql: error: connection to server at "aws-0-us-east-1.pooler.supabase.com" (44.216.29.125), port 5432 failed: error received from server in SCRAM exchange: Wrong password**"

If you reset your password for your project, it may take a few minutes for it to reflect. Try again after a few minutes and it should be fine assuming you correctly set the password in the connection string.
