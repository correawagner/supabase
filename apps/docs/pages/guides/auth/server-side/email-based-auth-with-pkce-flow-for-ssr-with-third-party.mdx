import Layout from '~/layouts/DefaultGuideLayout'

export const meta = {
  title: 'Email Auth with PKCE flow for SSR using a third-party email provider',
  description:
    'Learn how to configure email authentication in your server-side rendering (SSR) application to work with the PKCE flow using a third-party email provider.',
  subtitle:
    'Learn how to configure email authentication in your server-side rendering (SSR) application to work with the PKCE flow using a third-party email provider.',
}

### Generate link for sending with third-party email provider

If you use a third-party email provider to manually send the emails, for example for implementing i18n for emails, you can generate the link to send to the user with the following code

**Confirm signup template**

```ts
const linkResult = await supabase.auth.admin.generateLink({
    email: "current@email.com",
    type: "signup",
});

const tokenHash = linkResult.data.properties.hashed_token;

const link = `<site_url>/auth/confirm?type=signup&token_hash=${tokenHash}`;

```

**Invite user template**

```ts
const linkResult = await supabase.auth.admin.generateLink({
    email: "new@email.com",
    type: "invite",
});

const tokenHash = linkResult.data.properties.hashed_token;

const link = `<site_url>/auth/confirm?type=invite&token_hash=${tokenHash}`;

```

**Magic Link template**

```ts
const linkResult = await supabase.auth.admin.generateLink({
    email: "current@email.com",
    type: "magiclink",
});

const tokenHash = linkResult.data.properties.hashed_token;

const link = `<site_url>/auth/confirm?type=magiclink&token_hash=${tokenHash}`;

```

**Change Email Address template sent to current email**

```ts
const linkResult = await ctx.supabaseServerClient.auth.admin.generateLink({
  email: "current@email.com",
  newEmail: "new@email.com",
  type: "email_change_current",
});

const tokenHash = linkResult.data.properties.hashed_token;

const link = `<site_url>/auth/confirm?type=email_change_current&token_hash=${tokenHash}`;

```

**Change Email Address template sent to new email**

```ts
const linkResult = await ctx.supabaseServerClient.auth.admin.generateLink({
  email: "current@email.com",
  newEmail: "new@email.com",
  type: "email_change_new",
});

const tokenHash = linkResult.data.properties.hashed_token;

const link = `<site_url>/auth/confirm?type=email_change_new&token_hash=${tokenHash}`;

```

**Reset Password template**

```ts
const linkResult = await supabase.auth.admin.generateLink({
    email: "current@email.com",
    type: "recovery",
});

const tokenHash = linkResult.data.properties.hashed_token;

const link = `<site_url>/auth/confirm?type=recovery&token_hash=${tokenHash}`;

```

export const Page = ({ children }) => <Layout meta={meta} children={children} />

export default Page